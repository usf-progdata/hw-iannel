---
title: "hw3"
author: "Ian Nel"
date: "2/22/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(reshape2)
library(kableExtra)
library(scales)
```

# Homework 03

You will analyze data looking at the relationship between **green reputation** and three personality traits--**compassion**, **intellectual curiosity**, and **openness to experiences**.
The dataset includes data from **students** and **non-students**.


```{r data}
dictionary <- readr::read_csv(here::here("hw_3", "green_dictionary.csv"))
green_data <- readr::read_csv(here::here("hw_3", "green_data.csv"))
```

For your assignment, do the following.

  1. Inspect the item responses (e.g., with graphs or by summarizing distinct values). 
     Is anything unusual?
  2. Compute total scores for the four scales. 
     Recode variables as needed.
  3. Rescale the variables so that they go from 0-100 instead of the original range.
     Name the recaled variables `*_pomp`.
  4. Make plots that illustrate the distributions of the 4 POMP-scored variables.
  5. Make scatterplots showing the relationships between **green reputation** and each personality trait.
     Include trend lines for **students** and **non-students**.
     What do these plots show?
  6. Compare **green reputation** for students and non-students using a **rainfall plot** (bar + density + data points).
  7. Compute a summary table of means, SDs, medians, minima, and maxima for the four total scores for students and non-students.
  
In your assignment, prepare an RMarkdown file that includes both the coding and (for 4-7) narrative descriptions of your results.

## 1) Inspect the item responses (e.g., with graphs or by summarizing distinct values). Is anything unusual?

```{r item inspection}
print(green_data)
summary(green_data) #some values are coded as -99, so I'm going to code them as

dat <- green_data %>% 
      na_if("-99")

summary(dat) #now minimum values are 1 (not -99)
```

## 2) Compute total scores for the four scales. Recode variables as needed.
```{r}
#see which variables need to be recoded
view(dictionary) 

#Reverse code items
reversed <- dictionary %>% 
  filter(Keying == -1) %>% 
  pull(Item)

datr <- dat %>% 
  mutate(
    across(all_of(reversed),
           ~ 6 - .x,
           .names = "{.col}r")
  )

#Using rowwise function to create total scores for each person 

datr2 <- datr %>% 
  rowwise() %>% 
  mutate(
   green_tot = mean(c(green1,green2r,green3,green4,green5), na.rm = FALSE),
         comp_tot = mean(c(comp1,comp2,comp3,comp4,comp5,comp6r,comp7r,comp8r,comp9r,comp10r), na.rm = FALSE),
         intel_tot = mean(c(intel1,intel2,intel3,intel4,intel5,intel6,intel7r,intel8r,intel9r,intel10r), na.rm =FALSE),
         open_tot = mean(c(open1,open2,open3,open4,open5,open6,open7r,open8r,open9r,open10r), na.rm = FALSE)
   )

summary(datr2)
```

##  3) Rescale the variables so that they go from 0-100 instead of the original range. Name the recaled variables `*_pomp`.
```{r}
#Using rowwise function to rescale scores for each person from a 1-5 to a 0-100 scale. 
datr3 <- datr2 %>% 
  rowwise() %>% 
  mutate(green_pomp = rescale(green_tot, to = c(0, 100), from = c(1,5)),
         comp_pomp = rescale(comp_tot, to = c(0, 100), from = c(1,5)),
         intel_pomp = rescale(intel_tot, to = c(0, 100), from = c(1,5)),
         open_pomp = rescale(open_tot, to = c(0, 100), from = c(1,5))
  )

```

## 4) Make plots that illustrate the distributions of the 4 POMP-scored variables.
```{r}
green_hist <- ggplot(datr3) +
  aes(x = green_pomp, y = ..density..) +
  geom_histogram(color="springgreen",fill="dark green", binwidth = 5)+
  geom_density(alpha = .1, fill = "black")

comp_hist <- ggplot(datr3) +
  aes(x = comp_pomp, y = ..density..) +
  geom_histogram(color = "midnightblue", fill="pink", binwidth = 5)+
  geom_density(alpha = .1, fill = "black")

intel_hist <- ggplot(datr3) +
  aes(x = intel_pomp, y = ..density..) +
  geom_histogram(color = "darkorchid2", fill="gold", binwidth = 5) +
  geom_density(alpha = .1, fill = "black")

open_hist <- ggplot(datr3) +
  aes(x = open_pomp, y = ..density..) +
  geom_histogram(color="black", fill="turquoise2", binwidth = 5) +
  geom_density(alpha = .1, fill = "black")

gridExtra::grid.arrange(green_hist,comp_hist,intel_hist,open_hist)
```
### Narrative Description 
These histograms demonstrate that these variables have a relatively normal distribution, except for "comp_pomp" which is skewed to the left. "Intel_pomp" also appears to be somewhat bimodal. 

## 5) Make scatterplots showing the relationships between **green reputation** and each personality trait. Include trend lines for **students** and **non-students**. What do these plots show?
```{r}


```

## 6) Compare **green reputation** for students and non-students using a **rainfall plot** (bar + density + data points).
```{r}


```

## 7) Compute a summary table of means, SDs, medians, minima, and maxima for the four total scores for students and non-students.
```{r}


```

